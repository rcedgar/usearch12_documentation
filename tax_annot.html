
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
 <head>
  <meta content="en-us" http-equiv="Content-Language"/>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <meta content="no-cache, no-store, must-revalidate" http-equiv="Cache-Control"/>
  <meta content="no-cache" http-equiv="Pragma"/>
  <meta content="0" http-equiv="Expires"/>
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-50117757-1">
  </script>
  <script>
   window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-50117757-1');
  </script>
  <title>
   allpairs_global command
  </title>
  <link href="stylesx.css" rel="stylesheet" type="text/css"/>
  <style type="text/css">
   body.c4 {background-color:#c0c0c0;}
  div.c3 {position:absolute; top:45px; left:20px; width:830px; background-color:#ffffff; border-width:10px; border-style:solid;border-color:white;}
  span.c2 {font-weight: bold}
  div.c1 {position:absolute; top:10px; left:20px; width:850px; height:60px;}
    .TopButtonPara       { color:white; background-color:rgb(50,100,150); border-color:rgb(50,100,150); font-family:Arial, Helvetica, sans-serif; font-weight:normal; font-size:9pt; text-align:center; border-width:4px; border-style:solid; }
    .TopButton           { color:white; }
    a.TopButton:link     { text-decoration:none; }
    a.TopButton:visited  { text-decoration:none; }
    a.TopButton:hover    { color:orange; }

    .NewButtonPara       { color:white; background-color:rgb(50,100,150); border-color:rgb(50,100,150); font-family:Arial, Helvetica, sans-serif; font-weight:normal; font-size:9pt; text-align:center; border-width:4px; border-style:solid; }
    .NewButton           { color:white; }
    a.NewButton:link     { text-decoration:none; }
    a.NewButton:visited  { text-decoration:none; }
    a.NewButton:hover    { color:orange; }

    .SideButtonPara       { color:white; font-family:Arial, Helvetica, sans-serif; font-size:9pt; font-weight:normal; text-align:center; line-height:18px; }
    .SideButton           { color:white; }
    a.SideButton:link     { text-decoration:none; }
    a.SideButton:visited  { text-decoration:none; }
    a.SideButton:hover    { color:orange; }
  </style>
 </head>
 <body style="background-color:#c0c0c0;">
  <div>
   <a href="https://drive5.com/usearch">
    <img alt="USEARCH v12" src="usearch12_banner.jpg" style="position:absolute; top:40px; left:10px; padding:0px; border:0px;"/>
   </a>
  </div>
  <div style="position:absolute; top:115px; left:10px; width:850px; background-color:#ffffff; min-height:500px">
   <div style="position:relative; float:left; background-color:#696969; width:125px; left: 0px; min-height:500px; padding:5px; height: 125px;">
    <div class="SideButtonPara" style="text-align:center; padding-top:5px;">
     <a class="SideButton" href="index.html">
      Docs home
     </a>
     <br/>
     <hr style="border:0; border-bottom: 1px solid white;"/>
     <a class="SideButton" href="cmds_all.html">
      Commands
     </a>
     <br/>
     <a class="SideButton" href="topics.html">
      Topics
     </a>
     <br/>
     <a class="SideButton" href="citation.html">
      Publications
     </a>
     <br/>
    </div>
   </div>
   <div class="ManText" style="left:20px; position: absolute; left:135px; width:695px; background-color:white; padding:10px">
    <h1>
     <span class="ManText">
      <b>
       <a href="videos.html">
        <img alt="" height="56" src="video_lectures_tax.png" style="float: right" width="167"/>
       </a>
      </b>
     </span>
     Taxonomy annotations
    </h1>
    <p>
     <span class="ManText">
      <b>
       See also
       <br/>
      </b>
      <a href="cmd_sintax.html">
       sintax command
      </a>
      <br/>
      <a href="DELETE_URL">
       nbc_tax command
      </a>
      <br/>
      <a href="DELETE_URL">
       tax_stats command
      </a>
      <br/>
      <b>
      </b>
      <a href="DELETE_URL">
       makeudb_sintax command
      </a>
      <b>
       <br/>
      </b>
      <a href="tax_pred.html">
       Taxonomy predictions
      </a>
     </span>
    </p>
    <p>
     <span class="ManText">
      Taxonomy annotations specify the taxonomy of a sequence in a reference database. A taxonomy annotation is specified as a tax=names field in the
      <a href="sequence_labels.html">
       sequence label
      </a>
      . The tax=names field is separated from other fields in the labels by a semi-colon, for example:
     </span>
    </p>
    <p class="ManCode">
     <span class="c2">
      &gt;AB008314;tax=d:Bacteria,p:Firmicutes,c:Bacilli,o:Lactobacillales,
      <br/>
      f:Streptococcaceae,g:Streptococcus;
     </span>
    </p>
    <p>
     (Note the label must be on a single line; the example above is shown on two 
  lines because there isn't room on the web page).
    </p>
    <p>
     <span class="ManText">
      Taxon names are separated by commas. A name must start with a single letter specifying the taxonomic level followed by a semi-colon. Supported levels are shown in the table below.
     </span>
    </p>
    <table border="0" cellpadding="5" cellspacing="0" summary="Table" width="36%">
     <tr>
      <td align="right" class="ManText c3" valign="top" width="29">
       <span class="ManText">
        k
       </span>
      </td>
      <td align="left" class="ManText c4" valign="top" width="137">
       <span class="ManText">
        Kingdom
       </span>
      </td>
      <td align="right" class="ManText c3" valign="top" width="17">
       o
      </td>
      <td align="left" class="ManText c4" valign="top" width="70">
       Order
      </td>
     </tr>
     <tr>
      <td align="right" class="ManText c5" valign="top" width="29">
       <span class="ManText">
        d
       </span>
      </td>
      <td align="left" class="ManText c6" valign="top" width="137">
       <span class="ManText">
        Domain
       </span>
      </td>
      <td align="right" class="ManText c5" valign="top" width="17">
       f
      </td>
      <td align="left" class="ManText c6" valign="top" width="70">
       Family
      </td>
     </tr>
     <tr>
      <td align="right" class="ManText c3" valign="top" width="29">
       <span class="ManText">
        p
       </span>
      </td>
      <td align="left" class="ManText c4" valign="top" width="137">
       <span class="ManText">
        Phylum
       </span>
      </td>
      <td align="right" class="ManText c3" valign="top" width="17">
       g
      </td>
      <td align="left" class="ManText c4" valign="top" width="70">
       Genus
      </td>
     </tr>
     <tr>
      <td align="right" class="ManText c5" valign="top" width="29">
       c
      </td>
      <td align="left" class="ManText c6" valign="top" width="137">
       Class
      </td>
      <td align="right" class="ManText c5" valign="top" width="17">
       s
      </td>
      <td align="left" class="ManText c6" valign="top" width="70">
       Species
      </td>
     </tr>
    </table>
    <p>
     <span class="ManText">
      It is not required that the same set of levels appear in all labels. Levels may be omitted, and there may be different lowest levels in different labels. So the following label could appear in the same reference database as the example above:
     </span>
    </p>
    <p class="ManCode">
     <span class="c2">
      &gt;M59123;tax=d:Bacteria,p:Firmicutes,c:Clostridia,f:Halobacteroidaceae;
      <br/>
      <br/>
      <span class="ManText">
       Note that order and genus are not present.
      </span>
     </span>
    </p>
    <p class="ManCode">
     <span class="ManText">
      Commas and semi-colons are not permitted in taxon names. They could be replace by another punctuation character, e.g. underscore. Otherwise, any character other than end-of-line is allowed, including colons. Parentheses ( ... ) are allowed but are discouraged as they may confuse scripts which parse
      <a href="tax_pred.html">
       taxonomy predictions
      </a>
      .
     </span>
    </p>
    <p class="ManCode">
     <span class="ManText">
      Names which are entirely blank or empty must not be included. These are indicated by omitting the rank entirely. For example, the Greengenes convention is to include all ranks but not specify the name, as in:
     </span>
    </p>
    <p class="ManCode">
     <span class="c2">
      f__Mycobacteriaceae; g__Mycobacterium; s__
     </span>
    </p>
    <p class="ManText">
     <span class="c2">
      (HIgher levels omitted for brevity). In sintax notation, the species would be omitted:
     </span>
    </p>
    <p class="ManCode">
     <span class="c2">
      tax=f:Mycobacteriaceae,g:Mycobacterium;
     </span>
    </p>
    <p class="ManCode">
     <span class="ManText">
      White space (blanks and tabs) is allowed within a taxon name, but otherwise is not allowed in the taxonomy annotation, so for example a space after a comma is not allowed. If white space is present, the the -
      <a href="opt_notrunclabels.html">
       notrunclabels
      </a>
      option must be used when the reference database is in FASTA format. The -notrunclabels option is not required if the database has been converted to .udb format using the
      <a href="DELETE_URL">
       makeudb_sintax
      </a>
      command.
     </span>
    </p>
    <p class="ManCode">
     <span class="ManText">
      Non-ASCII characters (8-bit or
      <a href="https://en.wikipedia.org/wiki/Unicode">
       Unicode
      </a>
      ) should not be used. These are sometimes found in clade names, e.g. genus Heteroepichloë in UNITE (notice the dots over the last e). Like most command-line informatics programs, USEARCH assumes plain old 7-bit ASCII text files and does not understand other formats such as
      <a href="https://en.wikipedia.org/wiki/UTF-8">
       UTF-8
      </a>
      which have ASCII as a subset.
      <a href="find_8bit.html">
       See here
      </a>
      for a python script that finds non-ASCII characters in a text file. I use this script to find names with non-ASCII characters then manually edit, e.g. replace ë by e.
     </span>
    </p>
    <p class="ManCode">
     <span class="ManText">
      The complete set of clade names and their parent-child relationships is implicitly specified by the annotations in a FASTA file. No separate file is required to specify other information about the taxonomy. The taxonomy need not be fully consistent with a tree, meaning that some taxa may have more than one parent, e.g. a given family name may appear in two different orders. This allows the use of names such as "incertae sedis", "sp." and "unknown" which do not correspond to true taxa.
     </span>
    </p>
    <p class="ManCode">
     <span class="ManText">
      The
      <a href="DELETE_URL">
       tax_stats command
      </a>
      can be used to check that annotations are correctly formatted.
      <br/>
     </span>
    </p>
   </div>
  </div>
 </body>
</html>
